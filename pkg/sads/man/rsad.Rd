\name{rsad}
\alias{rsad}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{Poisson and Negative Binomial Sampling of a community sad
}
\description{
A given number of realizations of a probability distribution (species
abundances in a community) is sampled by a Poisson or Negative Binomial process. 
}
\usage{
rsad(S, frac, sad, samp=c("Poisson","Negbinom"), k , zeroes=FALSE, ...)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{S}{
positive integer; number of species in the community, which is the number of random deviates
generated by the probability distribution given by sad argument
}
\item{frac}{
  single numeric '0<frac<=1'; fraction of the community sampled
}
\item{sad}{
name; root name of community sad distribution - e.g., 'lnorm' for the lognormal distribution; 'geom' for the geometric distribution.
}

\item{samp}{
  matched character; sampling process (Poisson or negative binomial)
}
\item{k}{
positive; size parameter for the sampling binomial negative 
}
\item{zeroes}{
  logical; should zero values be included in the returned vector?
}
\item{...}{
parameters to be passed to the probability function defined
by the argument sad
}
}
\details{
This function simulates a random sample taken from a community with S
species. The expected species abundances in the sampled community follow a
probability distribution given by the argument 'sad'. A fraction 'frac' of
the community is sampled, thus the expected abundance in the sample of each
species is frac*n, where n is the species' expected abundance in the
community.

Two sampling processes can be simulated: a Poisson sample,
where individuals are sampled independently, and Negative Binomial
sample, where individuals are aggregated over sampling units.

In general terms, this function takes a Poisson or Negative
Binomial sampling with reposition of a vector of S realizations of a random variable,
with the sampling intensity given by 'frac'. The resulting values are
realizations of a Poisson (or a Negative Binomial) random variable where the
parameter that correspond to the mean (=expected value of the variable) follows a probability
distribution given by sad.
}
\value{
vector of (zero truncated) abundances in the sample
}
\references{

  Pielou, E.C. 1977. \emph{Mathematical Ecology}. New York: John Wiley
  and Sons.
  
  Green,J. and Plotkin, J.B. 2007 A statistical theory for sampling species abundances. \emph{Ecology Letters 10}:1037--1045
}
\author{
Paulo I. Prado & Cristiano Strieder
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
dexp, dpois, dpoix
}

\examples{

##A Poisson sample from a community with an exponential sad
exp.samp <- rsad(S=200,frac=0.05,exp,"Poisson",rate=1/250,zeroes=TRUE)
hist(exp.samp, prob=TRUE, xlab="Abundance in the sample")
lines(0:max(exp.samp),dpoix(0:max(exp.samp),frac=0.05, rate=1/250), col="blue")
}