fit.logser <- function(x=NULL,size=NULL,rich=NULL){
  if(!is.null(x)){
    S <- length(x)
    N <- sum(x)
    if(!is.null(size)|!is.null(rich)){
      warning(paste("Model fitted with size = ",N," and rich = ",S," \n calculated from supplied abundances"))
    }
  }
  if(is.null(x)&!is.null(size)&!is.null(rich)){
    S <- rich
    N <- size
  }

  if(is.null(x)&is.null(size)&is.null(rich)){
    stop("Please provide size and species number or a vector of species abundances")
  }
  f1 <- function(a) {
        S + a * log((a/(a + N))) #thanks to function fishers.alpha of untb package
    }
  sol <- uniroot(f1, interval = c(1/N, N))
  alfa=sol$root
  X <- N/(N+alfa)
  results <- list(summary=c(N=as.integer(N),S=as.integer(S),alpha=alfa,X=X,logLik=NULL,AIC=NULL),sol=sol)
  if(!is.null(x)){
    LL <- sum(log(dls(x,N,alfa)))
    aic <- -2*LL+2
    results$summary <- c(results$summary,loglik=LL,AIC=aic)
    results
  }
  results
}
